<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Meritocracy and distributive preferences ISSP</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="..\input\bib\style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Meritocratic beliefs and preferencias redistributivas</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="prod_prep-data.html">Data preparation</a>
</li>
<li>
  <a href="prod_analysis.html">Analysis</a>
</li>
<li>
  <a href="paper.html">Paper</a>
</li>
<li>
  <a href="https://github.com/juancarloscastillo/meritocracy-preferences">
    <span class="fa fa-github fa-lg"></span>
     
    
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Meritocracy and distributive preferences ISSP</h1>
<h4 class="date">jueves 04 junio 2020 2:38:32</h4>

</div>


<p>Hacer una descripcion de la linea de trabajo en general.</p>
<p><strong>Libraries</strong></p>
<pre class="r"><code>library(sjPlot)
library(sjmisc) # several functions,ej read_stata
library(descr)
library(memisc)  # codebook
library(psych) # cor2latex
library(corrplot) # graph correlations
library(lavaan)
library(stargazer) 
library(semTools)
library(plyr) # count
library(dplyr)
library(car) # recode
library(ggplot2)
library(Hmisc)
library(tidyverse)
library(data.table)
library(stringr)
library(countrycode)
library(lme4)
library(texreg)
library(mice)
library(ggrepel) # for scatter labels in sjp.scatter    
library(semPlot)
library(haven)
library(sjlabelled) 
library(kableExtra)</code></pre>
<p><strong>Load data</strong></p>
<pre class="r"><code>load(file = &quot;input/data/proc/redistrib.rda&quot;)</code></pre>
<div id="descriptives" class="section level1">
<h1><span class="header-section-number">1</span> Descriptives</h1>
<pre class="r"><code>  # Summary table to latex
    sink(&quot;output/results/desctab_red.html&quot;)
    stargazer(redistrib[-c(1,2)], type=&quot;html&quot;); sink()</code></pre>
<table style="text-align:center">
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Statistic
</td>
<td>
N
</td>
<td>
Mean
</td>
<td>
St. Dev.
</td>
<td>
Min
</td>
<td>
Pctl(25)
</td>
<td>
Pctl(75)
</td>
<td>
Max
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
income_dif
</td>
<td>
54,400
</td>
<td>
3.900
</td>
<td>
1.100
</td>
<td>
1.000
</td>
<td>
3.000
</td>
<td>
5.000
</td>
<td>
5.000
</td>
</tr>
<tr>
<td style="text-align:left">
unemployed
</td>
<td>
54,698
</td>
<td>
3.900
</td>
<td>
0.990
</td>
<td>
1.000
</td>
<td>
3.000
</td>
<td>
5.000
</td>
<td>
5.000
</td>
</tr>
<tr>
<td style="text-align:left">
taxes
</td>
<td>
53,258
</td>
<td>
4.000
</td>
<td>
0.780
</td>
<td>
1.000
</td>
<td>
4.000
</td>
<td>
5.000
</td>
<td>
5.000
</td>
</tr>
<tr>
<td style="text-align:left">
health
</td>
<td>
54,237
</td>
<td>
2.500
</td>
<td>
1.300
</td>
<td>
1.000
</td>
<td>
1.000
</td>
<td>
4.000
</td>
<td>
5.000
</td>
</tr>
<tr>
<td style="text-align:left">
educ
</td>
<td>
54,220
</td>
<td>
2.500
</td>
<td>
1.300
</td>
<td>
1.000
</td>
<td>
1.000
</td>
<td>
4.000
</td>
<td>
5.000
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
<div id="plot-likert" class="section level2">
<h2><span class="header-section-number">1.1</span> plot likert</h2>
<p><img src="../output/images/plotlikert.png" /></p>
</div>
</div>
<div id="estimación-del-modelo" class="section level1">
<h1><span class="header-section-number">2</span> Estimación del modelo</h1>
<pre class="r"><code>    load(&quot;input/data/proc/redistrib.rda&quot;)  

    cfa_red1 &lt;- &#39;
    # latent variables
    redist =~ income_dif + unemployed + taxes 
    accum  =~ health + educ&#39;
    
    
    fit_red1 &lt;- cfa(cfa_red1,data=redistrib, missing = &quot;ML&quot;) 
#summary(fit_red1, fit.measures=TRUE,standardized=TRUE)   

#fitmeasures(fit_red1)</code></pre>
<div id="measurement-structure" class="section level2">
<h2><span class="header-section-number">2.1</span> Measurement structure</h2>
<pre class="r"><code>        # Path
# dev.copy(&quot;output/results/path_red1.png&quot;,width=750,height=600)
    
        semPlot::semPaths(fit_red1,layout = &quot;tree2&quot;, rotation = 2, 
        intercepts = FALSE, style = &quot;lisrel&quot;, curvePivot = TRUE,
        cardinal = TRUE)</code></pre>
<p><img src="prod_analysis_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code># dev.off()          </code></pre>
<div id="fit-cfa-model" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Fit cfa model</h3>
<pre class="r"><code>sum_fit&lt;- bind_rows(fitmeasures(fit_red1)[c(&quot;chisq&quot;,&quot;df&quot;,&quot;cfi&quot;,&quot;rmsea&quot;,&quot;rmsea.ci.lower&quot;,&quot;rmsea.ci.upper&quot;)])

colnames &lt;- c(&quot;$\\chi2$&quot;,&quot;df&quot;,&quot;CFI&quot;,&quot;RMSEA&quot;,&quot;RMSEA CI lower&quot;, &quot;RMSEA CI upper&quot;)

sumtable01&lt;- kable(sum_fit,digits = 3,format = &quot;html&quot;,row.names = F,booktabs=T, caption = &quot;Summary fit indices wave 01&quot;,col.names = colnames,escape = FALSE) %&gt;%
  kable_styling(full_width = F)  %&gt;%
      collapse_rows(columns = 1,valign = &quot;middle&quot;);sumtable01</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Summary fit indices wave 01
</caption>
<thead>
<tr>
<th style="text-align:right;">
<span class="math inline">\(\chi2\)</span>
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
CFI
</th>
<th style="text-align:right;">
RMSEA
</th>
<th style="text-align:right;">
RMSEA CI lower
</th>
<th style="text-align:right;">
RMSEA CI upper
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
269
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.034
</td>
<td style="text-align:right;">
0.031
</td>
<td style="text-align:right;">
0.038
</td>
</tr>
</tbody>
</table>
</div>
<div id="diagram-model" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Diagram model</h3>
<pre class="r"><code>        # Path - with results
          semPlot::semPaths(fit_red1,&quot;std&quot;,layout = &quot;tree2&quot;, rotation = 2, 
        intercepts = FALSE, style = &quot;lisrel&quot;, curvePivot = TRUE,
        cardinal = TRUE, edge.color = &quot;black&quot;, residScale = 10)</code></pre>
<p><img src="prod_analysis_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>#         dev.copy(png,&quot;output/results/path_red1_res.png&quot;,
#           width=750,height=600); dev.off()        
          
    # Categorical     
        fit_red1c &lt;- cfa(cfa_red1,data=redistrib, 
            ordered = c(&quot;income_dif&quot;,&quot;unemployed&quot;,&quot;taxes&quot;, &quot;health&quot;, 
            &quot;educ&quot;)) 
    #   summary(fit_red1c, fit.measures=TRUE,standardized=TRUE)
#                                         </code></pre>
</div>
<div id="factor-scores" class="section level3">
<h3><span class="header-section-number">2.1.3</span> 2.4 Factor scores</h3>
<pre class="r"><code>        D1 &lt;- complete(out, 1) 
        D2 &lt;- complete(out, 2) 
        D3 &lt;- complete(out, 3) 
        D4 &lt;- complete(out, 4) 
        D5 &lt;- complete(out, 5) 
            
        # fit model for each complete dataset 
        fit1 &lt;- cfa(cfa_red1, data=D1) 
        fit2 &lt;- cfa(cfa_red1, data=D2) 
        fit3 &lt;- cfa(cfa_red1, data=D3) 
        fit4 &lt;- cfa(cfa_red1, data=D4) 
        fit5 &lt;- cfa(cfa_red1, data=D5) 
        
    # predict scores for all models 
        p1 &lt;- predict(fit1) 
        p2 &lt;- predict(fit2) 
        p3 &lt;- predict(fit3) 
        p4 &lt;- predict(fit4) 
    p5 &lt;- predict(fit5) 

# compute &#39;average&#39; across 5 sets of scores: 
        scores &lt;- (p1 + p2 + p3 + p4 + p5)/5 

 #Generate factor scores      
   scores_dat=as.data.frame(scores)

    
# Adaptar base para agregar factor scores (sacar todos NA)  
   redistrib_m=redistrib[rowSums(is.na(redistrib[3:7]))!=5,]</code></pre>
<pre class="r"><code># Merge with factor scores
      redistrib_sco=cbind(redistrib,scores)
        
      # Check
       stargazer(redistrib_sco[,8:9], type =&quot;html&quot;)</code></pre>
<table style="text-align:center">
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Statistic
</td>
<td>
N
</td>
<td>
Mean
</td>
<td>
St. Dev.
</td>
<td>
Min
</td>
<td>
Pctl(25)
</td>
<td>
Pctl(75)
</td>
<td>
Max
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
redist
</td>
<td>
56,021
</td>
<td>
-0.000
</td>
<td>
0.640
</td>
<td>
-2.500
</td>
<td>
-0.370
</td>
<td>
0.490
</td>
<td>
0.970
</td>
</tr>
<tr>
<td style="text-align:left">
accum
</td>
<td>
56,021
</td>
<td>
0.000
</td>
<td>
1.100
</td>
<td>
-1.400
</td>
<td>
-1.000
</td>
<td>
0.820
</td>
<td>
2.400
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
<pre class="r"><code>    # Save  factor scores
     # save(redistrib_sco, file=&quot;input/data/proc/redistrib_sco.rda&quot;)</code></pre>
</div>
</div>
<div id="models-a-merit-redistrib" class="section level2">
<h2><span class="header-section-number">2.2</span> MODELS A: MERIT &amp; REDISTRIB</h2>
<pre class="r"><code># 4.1 Merge objects --------------------- ---- 
    load(&quot;input/data/proc/redistrib.rda&quot;)
    load(&quot;input/data/proc/getahead.rda&quot;)                       
    load(&quot;input/data/proc/detearn.rda&quot;)

    aux1 &lt;- merge(getahead,redistrib,by=c(&quot;id&quot;,&quot;v5&quot;))
  merit_redist=merge(aux1,detearn,by=c(&quot;id&quot;,&quot;v5&quot;))</code></pre>
</div>
<div id="measurement-structural-mode" class="section level2">
<h2><span class="header-section-number">2.3</span> Measurement &amp; structural mode</h2>
<div id="measurement-simple" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Measurement simple</h3>
<pre class="r"><code>      cfa_mer_red1 &lt;- &#39;
      # latent variables
          merit =~ hwork + ambition 
          parent=~ wealthy + pareduc
          backg=~ race + gender
            network=~ people + polcone
          bmerit =~ welljob + hardjob 
          need=~ family + child
            redist =~ income_dif + unemployed + taxes 
        accum  =~ health + educ&#39;        
    
fit_mer_red1 &lt;- cfa(cfa_mer_red1,data=merit_redist,missing = &quot;ML&quot;) 
     
    
#    summary(fit_mer_red1, fit.measures=TRUE,standardized=TRUE)
        
              
      fit_mer_red1c &lt;- cfa(cfa_mer_red1,data=merit_redist,
        ordered = names(merit_redist[3:10,19:29]))
    #   summary(fit_mer_redc, fit.measures=TRUE,standardized=TRUE)
      
      
      
sum_fit&lt;- bind_rows(fitmeasures(fit_mer_red1)[c(&quot;chisq&quot;,&quot;df&quot;,&quot;cfi&quot;,&quot;rmsea&quot;,&quot;rmsea.ci.lower&quot;,&quot;rmsea.ci.upper&quot;)],
                    fitmeasures(fit_mer_red1c)[c(&quot;chisq&quot;,&quot;df&quot;,&quot;cfi&quot;,&quot;rmsea&quot;,&quot;rmsea.ci.lower&quot;,&quot;rmsea.ci.upper&quot;)])
sum_fit$mod &lt;- c(&quot;Model 1&quot;,&quot;Model 2&quot;)
sum_fit$est &lt;- c(&quot;MLR&quot;,&quot;DWLS&quot;)
#sum_fit &lt;- select(sum_fit,mod,est,everything())
colnames &lt;- c(&quot;Model&quot;,&quot;Estimator&quot;,&quot;$\\chi2$&quot;,&quot;df&quot;,&quot;CFI&quot;,&quot;RMSEA&quot;,&quot;RMSEA CI lower&quot;, &quot;RMSEA CI upper&quot;)
      
sumtable01&lt;- kable(sum_fit,digits = 3,format = &quot;html&quot;,row.names = F,booktabs=T, caption = &quot;Summary fit indices wave 01&quot;,col.names = colnames,escape = FALSE) %&gt;%
  kable_styling(full_width = F)  %&gt;%
      collapse_rows(columns = 1,valign = &quot;middle&quot;)  %&gt;%
      footnote(number = c(&quot;Model 1: Continue item&quot;,
                          &quot;Model 2: Ordered item)&quot;));sumtable01</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Summary fit indices wave 01
</caption>
<thead>
<tr>
<th style="text-align:right;">
Model
</th>
<th style="text-align:right;">
Estimator
</th>
<th style="text-align:right;">
<span class="math inline">\(\chi2\)</span>
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
CFI
</th>
<th style="text-align:right;">
RMSEA
</th>
<th style="text-align:left;">
RMSEA CI lower
</th>
<th style="text-align:left;">
RMSEA CI upper
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
4521
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.030
</td>
<td style="text-align:right;">
0.029
</td>
<td style="text-align:right;">
0.031
</td>
<td style="text-align:left;">
Model 1
</td>
<td style="text-align:left;">
MLR
</td>
</tr>
<tr>
<td style="text-align:right;">
1967
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.026
</td>
<td style="text-align:right;">
0.025
</td>
<td style="text-align:right;">
0.027
</td>
<td style="text-align:left;">
Model 2
</td>
<td style="text-align:left;">
DWLS
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup>1</sup> Model 1: Continue item
</td>
</tr>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup>2</sup> Model 2: Ordered item)
</td>
</tr>
</tfoot>
</table>
<pre class="r"><code>        # Path

    #         dev.copy(png,&quot;output/results/path_mer_red1.png&quot;,width=800,height=650)
              semPlot::semPaths(fit_mer_red1,layout = &quot;circle&quot;, rotation = 3, 
                intercepts = FALSE, style = &quot;lisrel&quot;, curvePivot = TRUE,
                sizeMan = 4, sizeLat = 6)</code></pre>
<p><img src="prod_analysis_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre class="r"><code>    #           dev.off()</code></pre>
<pre class="r"><code>    # CFA with secon order unmerit

      cfa_mer_red2 &lt;- &#39;
      # latent variables
          merit =~ hwork + ambition 
          parent=~ wealthy + pareduc
          backg=~ race + gender
            network=~ people + polcone
          bmerit =~ welljob + hardjob 
          need=~ family + child
            redist =~ income_dif + unemployed + taxes 
        accum  =~ health + educ
            unmerit =~ parent + backg + network
      &#39;     
      fit_mer_red2 &lt;- cfa(cfa_mer_red2,data=merit_redist, 
        missing = &quot;ML&quot;) 
#     summary(fit_mer_red2, fit.measures=TRUE,standardized=TRUE)</code></pre>
<pre class="r"><code>sum_fit&lt;- bind_rows(fitmeasures(fit_mer_red2)[c(&quot;chisq&quot;,&quot;df&quot;,&quot;cfi&quot;,&quot;rmsea&quot;,&quot;rmsea.ci.lower&quot;,&quot;rmsea.ci.upper&quot;)])

colnames &lt;- c(&quot;$\\chi2$&quot;,&quot;df&quot;,&quot;CFI&quot;,&quot;RMSEA&quot;,&quot;RMSEA CI lower&quot;, &quot;RMSEA CI upper&quot;)

sumtable01&lt;- kable(sum_fit,digits = 3,format = &quot;html&quot;,row.names = F,booktabs=T, caption = &quot;Summary fit indices wave 01&quot;,col.names = colnames,escape = FALSE) %&gt;%
  kable_styling(full_width = F)  %&gt;%
      collapse_rows(columns = 1,valign = &quot;middle&quot;);sumtable01</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Summary fit indices wave 01
</caption>
<thead>
<tr>
<th style="text-align:right;">
<span class="math inline">\(\chi2\)</span>
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
CFI
</th>
<th style="text-align:right;">
RMSEA
</th>
<th style="text-align:right;">
RMSEA CI lower
</th>
<th style="text-align:right;">
RMSEA CI upper
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
5771
</td>
<td style="text-align:right;">
101
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.032
</td>
<td style="text-align:right;">
0.031
</td>
<td style="text-align:right;">
0.033
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="correlation-factor-scores" class="section level1">
<h1><span class="header-section-number">3</span> Correlation factor scores</h1>
<pre class="r"><code>        # Factor scores
      fscores &lt;- as.data.frame(lavPredict(fit_mer_red2))

      
        # Correlations
      cormat=cor(fscores[c(7,8,1,9,5,6)],
                 use=&quot;pairwise.complete.obs&quot;)
      corrplot.mixed(cormat)</code></pre>
<p><img src="prod_analysis_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="r"><code>      #save
    #  dev.copy(png,&quot;output/results/corplot_totscores.png&quot;,width=600,
     #          height=600); dev.off()</code></pre>
<pre class="r"><code>      #  Path
              semPlot::semPaths(fit_mer_red2,layout = &quot;tree&quot;, rotation = 2, 
                intercepts = FALSE, style = &quot;lisrel&quot;, curvePivot = TRUE,
                sizeMan = 4, sizeLat = 6)</code></pre>
<p><img src="prod_analysis_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<pre class="r"><code>            #  dev.copy(png,&quot;output/results/path_mer_red2.png&quot;,width=800,
           #    height=650);  dev.off()       
      
    # Structural model
      sem_mer_red1 &lt;- &#39;
      # latent variables
          merit =~ hwork + ambition 
          parent=~ wealthy + pareduc
          backg=~ race + gender
            network=~ people + polcone
          bmerit =~ welljob + hardjob 
          need=~ family + child
            redist =~ income_dif + unemployed + taxes 
        accum  =~ health + educ
            unmerit =~ parent + backg + network
        # regressions
            redist + accum ~ merit + unmerit + bmerit + need
      &#39;     
  
      fitsem_mer_red1 &lt;- sem(sem_mer_red1,data=merit_redist, 
        missing = &quot;ML&quot;) 
#     summary(fitsem_mer_red1, fit.measures=TRUE,standardized=TRUE)
      
      
      
      
        # Path
              semPlot::semPaths(fitsem_mer_red1,layout = &quot;tree&quot;, rotation = 2, 
                intercepts = FALSE, style = &quot;lisrel&quot;, curvePivot = TRUE,
            sizeMan = 4, sizeLat = 6)</code></pre>
<p><img src="prod_analysis_files/figure-html/unnamed-chunk-20-2.png" width="672" /></p>
<pre class="r"><code>         # dev.copy(png,&quot;output/results/path_mer_red2.png&quot;,width=800,
          # height=650);  dev.off()
        
    # saque este argumento del codigo de abajo  op==&quot;~&quot;
      
        # Table
        tabreg=subset(standardizedsolution(fitsem_mer_red1) ,op==&quot;~&quot;, select=c(lhs,rhs,est.std,z)) 
        tabreg2=subset(tabreg, select=c(lhs,rhs,est.std,z))
        tabredist=subset(tabreg2,lhs==&quot;redist&quot;,
            select=rhs:z)
        tabaccumt=subset(tabreg2,lhs==&quot;accum&quot;,select=est.std:z) 
        tabtot=cbind(tabredist,tabaccumt)
        tabtot2=rbind(tabtot$est.std,tabtot$z)
              
              
                  
# End sec 4 ----------------------------- </code></pre>
</div>
<div id="descriptives-x" class="section level1">
<h1><span class="header-section-number">4</span> Descriptives <strong>x</strong></h1>
<pre class="r"><code>    load(&quot;input/data/proc/pref_agg.rda&quot;)

  ############# no encuentro esta variable accum
    
    
    
####################### Faltan las variables accum y redist.
    
    plot_scatter(pref_agg, gini_net, accum, 
    dot.labels = pref_agg$v5c,
    fit.line = &quot;lm&quot;,
    show.ci = TRUE)</code></pre>
<p><img src="prod_analysis_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<pre class="r"><code>    #table(pref_agg$redis)
    
  plot_scatter(pref_agg, gini_net, redist, 
  dot.labels = pref_agg$v5c,
    fit.line = lm,
    show.ci = TRUE  )</code></pre>
<p><img src="prod_analysis_files/figure-html/unnamed-chunk-21-2.png" width="672" /></p>
<pre class="r"><code>  # Sin ZAF outlier (igual, no cambia)
        pref_agg2 &lt;- pref_agg[which(pref_agg$v5c!=&#39;ZAF&#39;), ]
          
          plot_scatter(pref_agg2,gini_net,redist, 
            dot.labels = pref_agg2$v5c,
            fit.line = lm,
            show.ci = TRUE
            )</code></pre>
<p><img src="prod_analysis_files/figure-html/unnamed-chunk-21-3.png" width="672" /></p>
</div>
<div id="models" class="section level1">
<h1><span class="header-section-number">5</span> Models</h1>
<pre class="r"><code>  #  Models SEM simple

    load(&quot;input/data/proc/pref.rda&quot;)
  
  sem_b &lt;- &#39;
    # latent variables
    redist =~ income_dif + unemployed + taxes 
    accum  =~ health + educ
        redist + accum ~ univ + quintile + sstatus + gini_market&#39;
  
    fit_2c &lt;- sem(sem_b,data=pref, ordered = c(&quot;income_dif&quot;,
      &quot;unemployed&quot;,&quot;taxes&quot;, &quot;health&quot;, &quot;educ&quot;))
    #summary(fit_2c, fit.measures=TRUE,standardized=TRUE)


sum_fit&lt;- bind_rows(fitmeasures(fit_red1)[c(&quot;chisq&quot;,&quot;df&quot;,&quot;cfi&quot;,&quot;rmsea&quot;,&quot;rmsea.ci.lower&quot;,&quot;rmsea.ci.upper&quot;)])


colnames &lt;- c(&quot;$\\chi2$&quot;,&quot;df&quot;,&quot;CFI&quot;,&quot;RMSEA&quot;,&quot;RMSEA CI lower&quot;, &quot;RMSEA CI upper&quot;)

sumtable01&lt;- kable(sum_fit,digits = 3,format = &quot;html&quot;,row.names = F,booktabs=T, caption = &quot;Summary fit indices wave 01&quot;,col.names = colnames,escape = FALSE) %&gt;%
  kable_styling(full_width = F)  %&gt;%
      collapse_rows(columns = 1,valign = &quot;middle&quot;);sumtable01</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Summary fit indices wave 01
</caption>
<thead>
<tr>
<th style="text-align:right;">
<span class="math inline">\(\chi2\)</span>
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
CFI
</th>
<th style="text-align:right;">
RMSEA
</th>
<th style="text-align:right;">
RMSEA CI lower
</th>
<th style="text-align:right;">
RMSEA CI upper
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
269
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.034
</td>
<td style="text-align:right;">
0.031
</td>
<td style="text-align:right;">
0.038
</td>
</tr>
</tbody>
</table>
<div id="multilevel-with-factor-scores" class="section level2">
<h2><span class="header-section-number">5.1</span> Multilevel (with factor scores)</h2>
<p>Estos codigos de abajo no especifican base de datos. las bases de datos con esas variables son pref_agg. pero esa base es o nivel uno (pref) o nivel 2 (pref_agg.)</p>
<p>—&gt; hacer una base de datos con ambos datos.</p>
<div id="check-simple-regresion-x" class="section level3">
<h3><span class="header-section-number">5.1.1</span> check simple regresion <strong>X</strong></h3>
<pre class="r"><code>#   ols_prefred=lm(redist ~ univ + quintile + sstatus + gini_market)
 # stargazer(ols_prefred, type = &quot;text&quot;) # ok, similar SEM, scores OK</code></pre>
</div>
</div>
<div id="multilevel-models-redist.-x" class="section level2">
<h2><span class="header-section-number">5.2</span> Multilevel models redist. <strong>X</strong></h2>
<pre class="r"><code>      # Null
      # mlprefred_0 = lmer(redist ~ 1 + (1 | v5c))
        #   screenreg(mlprefred_0) # de library texreg  </code></pre>
</div>
<div id="esta-seccion-no-me-funciona.-x" class="section level2">
<h2><span class="header-section-number">5.3</span> Esta seccion no me funciona. <strong>X</strong></h2>
<pre class="r"><code>    #       sjp.lmer(mlprefred_0, sort.est=&quot;(Intercept)&quot;) ### ¿Que grafico se quiere hacer?</code></pre>
<pre class="r"><code>#           # Graph
#     
            # ICC
#           varcomp=as.data.frame(VarCorr(mlprefred_0))
#           tau00=varcomp[1,4]
#           sigma2=varcomp[2,4]
#           tau00/(tau00+sigma2)
        
        # Individual level vars
#           mlprefred_1 = lmer(redist_n ~ 1 + univ + 
#                   as.factor(quintile_miss) +  sstatus + sex + age + 
#                   (1 | v5))
#           screenreg(mlprefred_1)
#           
#       # Macro level vars
#           mlprefred_2 = lmer(redist ~ 1 + univ + 
#                   as.factor(quintile_miss)+ sstatus + gini_market + 
#                   univ_g + (1 | v5))
#           screenreg(mlprefred_2)
#           
#   # Multilevel models accumulation
#           
      # Null
#       mlaccum_0 = lmer(accum ~ 1 + (1 | v5c))
#           screenreg(mlaccum_0) # de library texreg  
#     
            # Graph
#           sjp.lmer(mlaccum_0, sort.est=&quot;(Intercept)&quot;)
#           
            # ICC
#           varcomp=as.data.frame(VarCorr(mlaccum_0))
#           tau00=varcomp[1,4]
#           sigma2=varcomp[2,4]
#           tau00/(tau00+sigma2)
#       
#       # Individual level vars
#           mlaccum_1 = lmer(accum ~ 1 + univ + as.factor(quintile_miss) +  
#                   sstatus + sex + age + univ*sex + age*age + (1 | v5))
#           screenreg(mlaccum_1)
#           
        # Macro level vars
#           mlaccum_2 = lmer(accum ~ 1 + univ_g + as.factor(quintile_miss) +
#                   (sstatus -f_sstatus) + gini_net + (1 | v5))
#           screenreg(mlaccum_2)
            
        # Random slope &amp; cross-level
#           mlaccum_3 = lmer(accum ~ 1 + univ_g + f_sstatus + gini_net + 
#                   gini_net* f_sstatus +   (1 + f_sstatus | v5))
            
#           screenreg(mlaccum_3)    
            
#           # Graphs
#           sjp.lmer(mlaccum_3, sort.est = &quot;(Intercept)&quot;)
#           sjp.lmer(mlaccum_3, type = &quot;rs.ri&quot;)
#           
#           mlaccum_4 = lmer(accum ~ 1 + univ + f_sstatus + gini_net + gini_net*f_sstatus + hhincome +  (1 + hhincome | v5))
#           screenreg(mlaccum_4)    
            
# End sec. 5 ----------------------------           </code></pre>
</div>
</div>
<div id="models-c-meritocracy" class="section level1">
<h1><span class="header-section-number">6</span> MODELS C: MERITOCRACY</h1>
<div id="macro-descriptives" class="section level2">
<h2><span class="header-section-number">6.1</span> Macro Descriptives</h2>
<pre class="r"><code>    load(&quot;input/data/proc/meritocracy.rda&quot;)
      
  # Adjust data
    merit_agg=aggregate(meritocracy, by=list(meritocracy$v5c),
        FUN=mean, na.rm=TRUE)
    names(merit_agg)[names(merit_agg)==&quot;Group.1&quot;]=&quot;v5c&quot;
 #   names(merit_agg)
  #  dim(merit_agg)</code></pre>
<div id="macro-level-corr" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Macro level corr</h3>
<pre class="r"><code>      corMat &lt;- cor(merit_agg[c(&quot;merit&quot;,&quot;unmerit&quot;,&quot;bmerit&quot;,&quot;need&quot;,&quot;gini_net&quot;,&quot;gini_market&quot;,&quot;j_fi_index&quot;)], use=&quot;pairwise.complete.obs&quot;) # estimar matriz pearson
      options(digits=2)
 corrplot.mixed(corMat) </code></pre>
<p><img src="prod_analysis_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<pre class="r"><code>    plot_scatter(merit_agg, gini_net, bmerit, 
        dot.labels = merit_agg$v5c,
        fit.line = &quot;lm&quot;,
        show.ci = TRUE)</code></pre>
<p><img src="prod_analysis_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<pre class="r"><code>  # Save
# dev.copy(png,&quot;output/results/gini_bmerit.png&quot;) 
    
  plot_scatter(merit_agg, gini_net,unmerit, 
  dot.labels = merit_agg$v5c,
  fit.line = &quot;lm&quot;,
  show.ci = TRUE)    </code></pre>
<p><img src="prod_analysis_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<pre class="r"><code># dev.off()</code></pre>
<pre class="r"><code>#dev.copy(png,&quot;output/results/fi_need.png&quot;); 

  plot_scatter(merit_agg, gini_net,need, 
    dot.labels = merit_agg$v5c,
    fit.line = &quot;lm&quot;,
    show.ci = TRUE)  </code></pre>
<p><img src="prod_analysis_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<pre class="r"><code>#dev.off()</code></pre>
<pre class="r"><code> # dev.copy(png,&quot;output/results/gini_fi.png&quot;)
   plot_scatter(merit_agg, j_fi_index, need, 
        dot.labels = merit_agg$v5c,
        fit.line = &quot;lm&quot;,
        show.ci = TRUE)     </code></pre>
<p><img src="prod_analysis_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<pre class="r"><code>#  dev.off()</code></pre>
<div id="graficos-sin-outliers" class="section level4">
<h4><span class="header-section-number">6.1.1.1</span> Graficos sin outliers</h4>
<pre class="r"><code>merit_agg2 &lt;- merit_agg[which(merit_agg$v5c!=&quot;ZAF&quot; &amp; merit_agg$v5c!=&quot;CHN&quot; &amp;  merit_agg$v5c!=&quot;CHL&quot; ), ]
    
  plot_scatter(merit_agg2, gini_net, unmerit, 
    dot.labels = merit_agg2$v5c,
    fit.line = TRUE,
    show.ci = TRUE
        )  </code></pre>
<p><img src="prod_analysis_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="models-1" class="section level2">
<h2><span class="header-section-number">6.2</span> Models</h2>
<div id="multilevel-with-factor-scores-1" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Multilevel (with factor scores)</h3>
<pre class="r"><code>  load(&quot;input/data/proc/meritocracy.rda&quot;)

    # Adjust some variables
        meritocracy$Quintile=as.factor(meritocracy$quintile_miss)
        levels(meritocracy$Quintile)[6] &lt;- &quot;miss&quot;</code></pre>
<div id="check-simple-regresion" class="section level4">
<h4><span class="header-section-number">6.2.1.1</span> check simple regresion</h4>
<pre class="r"><code>      ols_merit=lm(merit ~ univ + Quintile + sstatus + gini_net, data = meritocracy)
      stargazer(ols_merit, type =&quot;html&quot;) # ok, similar SEM, scores OK</code></pre>
<table style="text-align:center">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
merit
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
univ
</td>
<td>
0.058<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.005)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Quintile2
</td>
<td>
0.016<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Quintile3
</td>
<td>
0.021<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Quintile4
</td>
<td>
0.027<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Quintile5
</td>
<td>
0.029<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Quintilemiss
</td>
<td>
0.010
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sstatus
</td>
<td>
0.0001
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.0002)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
gini_net
</td>
<td>
0.005<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.0002)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-0.190<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.009)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
54,634
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.012
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.011
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.470 (df = 54625)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
80.000<sup>***</sup> (df = 8; 54625)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div id="multilevel-models-merit" class="section level1">
<h1><span class="header-section-number">7</span> Multilevel models merit</h1>
<div id="null-model" class="section level2">
<h2><span class="header-section-number">7.1</span> Null Model</h2>
<pre class="r"><code>        mlmerit_0 = lmer(merit ~ 1 + (1 | v5c), data = meritocracy)
            htmlreg(mlmerit_0) # de library texreg  </code></pre>
&lt;!DOCTYPE HTML PUBLIC “-//W3C//DTD HTML 4.01 Transitional//EN” “<a href="http://www.w3.org/TR/html4/loose.dtd" class="uri">http://www.w3.org/TR/html4/loose.dtd</a>”&gt;
<table cellspacing="0" align="center" style="border: none;">
<caption align="bottom" style="margin-top:0.3em;">
Statistical models
</caption>
<tr>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b></b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Model 1</b>
</th>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
(Intercept)
</td>
<td style="padding-right: 12px; border: none;">
-0.01
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.03)
</td>
</tr>
<tr>
<td style="border-top: 1px solid black;">
AIC
</td>
<td style="border-top: 1px solid black;">
66347.55
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
BIC
</td>
<td style="padding-right: 12px; border: none;">
66374.29
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Log Likelihood
</td>
<td style="padding-right: 12px; border: none;">
-33170.77
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Num. obs.
</td>
<td style="padding-right: 12px; border: none;">
55021
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Num. groups: v5c
</td>
<td style="padding-right: 12px; border: none;">
40
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Var: v5c (Intercept)
</td>
<td style="padding-right: 12px; border: none;">
0.03
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid black;">
Var: Residual
</td>
<td style="border-bottom: 2px solid black;">
0.19
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;" colspan="3">
<span style="font-size:0.8em"><sup style="vertical-align: 0px;"><em><strong></sup>p &lt; 0.001, <sup style="vertical-align: 0px;"></strong></sup>p &lt; 0.01, <sup style="vertical-align: 0px;"></em></sup>p &lt; 0.05</span>
</td>
</tr>
</table>
<pre class="r"><code>            # Graph
        #   sjp.lmer(mlmerit_0, sort.est=&quot;(Intercept)&quot;)   No encuentro el paquete.
      
            # ICC
            varcomp=as.data.frame(VarCorr(mlmerit_0))
            tau00=varcomp[1,4]
            sigma2=varcomp[2,4]
            tau00/(tau00+sigma2)</code></pre>
<p>[1] 0.11</p>
<pre class="r"><code>        # Individual level vars
            mlmerit_1 = lmer(merit ~ 1 + univ + quintile_miss + 
                    sstatus + sex + age + (1 | v5), data = meritocracy)
            htmlreg(mlmerit_1)</code></pre>
&lt;!DOCTYPE HTML PUBLIC “-//W3C//DTD HTML 4.01 Transitional//EN” “<a href="http://www.w3.org/TR/html4/loose.dtd" class="uri">http://www.w3.org/TR/html4/loose.dtd</a>”&gt;
<table cellspacing="0" align="center" style="border: none;">
<caption align="bottom" style="margin-top:0.3em;">
Statistical models
</caption>
<tr>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b></b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Model 1</b>
</th>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
(Intercept)
</td>
<td style="padding-right: 12px; border: none;">
0.01
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.03)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
univ
</td>
<td style="padding-right: 12px; border: none;">
0.04<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.01)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
quintile_miss
</td>
<td style="padding-right: 12px; border: none;">
0.01<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.00)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
sstatus
</td>
<td style="padding-right: 12px; border: none;">
-0.00
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.00)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
sex
</td>
<td style="padding-right: 12px; border: none;">
-0.01
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.00)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
age
</td>
<td style="padding-right: 12px; border: none;">
-0.00<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.00)
</td>
</tr>
<tr>
<td style="border-top: 1px solid black;">
AIC
</td>
<td style="border-top: 1px solid black;">
65233.10
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
BIC
</td>
<td style="padding-right: 12px; border: none;">
65304.31
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Log Likelihood
</td>
<td style="padding-right: 12px; border: none;">
-32608.55
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Num. obs.
</td>
<td style="padding-right: 12px; border: none;">
54213
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Num. groups: v5
</td>
<td style="padding-right: 12px; border: none;">
40
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Var: v5 (Intercept)
</td>
<td style="padding-right: 12px; border: none;">
0.02
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid black;">
Var: Residual
</td>
<td style="border-bottom: 2px solid black;">
0.19
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;" colspan="3">
<span style="font-size:0.8em"><sup style="vertical-align: 0px;"><em><strong></sup>p &lt; 0.001, <sup style="vertical-align: 0px;"></strong></sup>p &lt; 0.01, <sup style="vertical-align: 0px;"></em></sup>p &lt; 0.05</span>
</td>
</tr>
</table>
<pre class="r"><code>        # Macro level vars
            mlmerit_2 = lmer(bmerit ~ 1 + gini_net + (1 | v5), data = meritocracy)
        htmlreg(mlmerit_2)    </code></pre>
&lt;!DOCTYPE HTML PUBLIC “-//W3C//DTD HTML 4.01 Transitional//EN” “<a href="http://www.w3.org/TR/html4/loose.dtd" class="uri">http://www.w3.org/TR/html4/loose.dtd</a>”&gt;
<table cellspacing="0" align="center" style="border: none;">
<caption align="bottom" style="margin-top:0.3em;">
Statistical models
</caption>
<tr>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b></b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Model 1</b>
</th>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
(Intercept)
</td>
<td style="padding-right: 12px; border: none;">
-0.04
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.04)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
gini_net
</td>
<td style="padding-right: 12px; border: none;">
0.00
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.00)
</td>
</tr>
<tr>
<td style="border-top: 1px solid black;">
AIC
</td>
<td style="border-top: 1px solid black;">
-14937.09
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
BIC
</td>
<td style="padding-right: 12px; border: none;">
-14901.43
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Log Likelihood
</td>
<td style="padding-right: 12px; border: none;">
7472.55
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Num. obs.
</td>
<td style="padding-right: 12px; border: none;">
55021
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Num. groups: v5
</td>
<td style="padding-right: 12px; border: none;">
40
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Var: v5 (Intercept)
</td>
<td style="padding-right: 12px; border: none;">
0.00
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid black;">
Var: Residual
</td>
<td style="border-bottom: 2px solid black;">
0.04
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;" colspan="3">
<span style="font-size:0.8em"><sup style="vertical-align: 0px;"><em><strong></sup>p &lt; 0.001, <sup style="vertical-align: 0px;"></strong></sup>p &lt; 0.01, <sup style="vertical-align: 0px;"></em></sup>p &lt; 0.05</span>
</td>
</tr>
</table>
</div>
</div>
<div id="models-meritocracy-and-preferences" class="section level1">
<h1><span class="header-section-number">8</span> Models meritocracy and preferences</h1>
<pre class="r"><code>  load(&quot;input/data/proc/meritocracy.rda&quot;)
  load(&quot;input/data/proc/redistrib_sco.rda&quot;)
            
    mer_pref=merge(meritocracy, redistrib_sco, by=c(&quot;id&quot;))
 #   names(mer_pref)
    
  mer_pref_agg=aggregate(mer_pref, by=list(mer_pref$v5c),
        FUN=mean, na.rm=TRUE)
      names(mer_pref_agg)[names(mer_pref_agg)==&quot;Group.1&quot;]=&quot;v5c&quot;
     #  names(mer_pref_agg)
  #  dim(mer_pref_agg)

  
    plot_scatter(mer_pref_agg,merit , bmerit, 
      dot.labels = mer_pref_agg$v5c,
      fit.line = lm,
      show.ci = TRUE)</code></pre>
<p><img src="prod_analysis_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<pre class="r"><code>    plot_scatter(mer_pref_agg, merit, redist, 
        dot.labels = mer_pref_agg$v5c,
        fit.line = lm,
        show.ci = TRUE) </code></pre>
<p><img src="prod_analysis_files/figure-html/unnamed-chunk-38-2.png" width="672" /></p>
<pre class="r"><code>      # Save
  #    dev.copy(png,&quot;loc_merit_pref_int/results/merit_redis.png&quot;); dev.off()
 
     plot_scatter(mer_pref_agg, unmerit,redist, 
        dot.labels = mer_pref_agg$v5c,
        fit.line = &quot;lm&quot;,
        show.ci = TRUE)      </code></pre>
<p><img src="prod_analysis_files/figure-html/unnamed-chunk-38-3.png" width="672" /></p>
<pre class="r"><code>       # Save
     # dev.copy(png,&quot;loc_merit_pref_int/results/unmerit_redis.png&quot;); dev.off()

  #    plot_scatter(mer_pref_agg$redist,mer_pref_agg$accum)
      
   plot_scatter(mer_pref_agg, redist,accum, 
    dot.labels = mer_pref_agg$v5c,
    fit.line = &quot;lm&quot;,
    show.ci = TRUE)  </code></pre>
<p><img src="prod_analysis_files/figure-html/unnamed-chunk-38-4.png" width="672" /></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
