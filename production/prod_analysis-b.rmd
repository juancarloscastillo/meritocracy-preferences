---
title: "Meritocracy and distributive preferences ISSP"
date: "`r format(Sys.time(), '%A %d %B %Y %X')`"
css: "../input/css/custom.css"
output:
  html_document:
    theme: flatly
    highlight: tango
    number_sections: true
    toc: true
    toc_float:
        collapsed: true
    toc_depth: 2
    code_folding: "hide"
editor_options:
  chunk_output_type: console
---
<div style="text-align: justify">

In this document "Analysis B" the analyzes performed on the database created in data-prep are exposed.

The first section provides a multilevel analysis of the variables redistributive preferences and preferences for accumulation. Analysis of random slopes and interactions between levels are included.

The second section presents the robustness analyzes.

***

```{r eval=FALSE, include=FALSE}
rmarkdown::render(input = "production/prod_analysis-cfa.rmd",output_format = "html_document"); browseURL(url = "production/prod_analysis-cfa.html")
```

```{r include=FALSE}
knitr::opts_chunk$set(warning = FALSE,message = FALSE, cache = FALSE)
knitr::opts_knit$set(root.dir = "../")
options(scipen=999)
rm(list=ls())
options(knitr.kable.NA = '')
```

**Libraries**
```{r}
library(sjPlot)
library(sjmisc) # several functions,ej read_stata
library(descr)
library(memisc)  # codebook
library(psych) # cor2latex
library(corrplot) # graph correlations
library(lavaan)
library(stargazer) 
library(semTools)
library(plyr) # count
library(dplyr)
library(car) # recode
library(ggplot2)
library(Hmisc)
library(tidyverse)
library(data.table)
library(stringr)
library(countrycode)
library(lme4)
library(texreg)
library(mice)
library(ggrepel) # for scatter labels in sjp.scatter	
library(semPlot)
library(haven)
library(sjlabelled) 
library(kableExtra)
library(ggeffects)
library(influence.ME)
library(lattice)
```

**Load data**

```{r}
load(file = "input/data/proc/redistrib.rda")
load(file = "input/data/proc/mer_pref.rda")
load("input/data/proc/redistrib.rda")
load("input/data/proc/getahead.rda")
load("input/data/proc/detearn.rda")
```

# Modelos Multinivel

## Modelos nulos: correlacion intraclase.

```{r results='asis'}
load(file="input/data/proc/mer_pref.rda")
# Modelo nulo
results_0_redist = lmer(redist ~ 1 + (1| v5c), data = mer_pref, REML=F)
results_0_accum  = lmer(accum ~ 1 + (1| v5c), data = mer_pref, REML=F)

htmlreg(list(results_0_redist,results_0_accum), 
        caption = "null model of Redistributive preferences and accumulation preferences", 
        custom.model.names = c("Redistributive", "Accumulation"), 
        caption.adove = T, star.symbol = "\\*") 

#reghelper::ICC(results_0_redist)
```


```{r out.width=c('50%', '50%'), fig.cap="Correlacion intraclase", fig.show='hold'}
# Modelo nulo
# Correlacion intraclases accum
df<-data.frame(Variance=c("Between","Whithin"),
               porcentaje=c(15,85))
ggplot(df,aes(x="",y=porcentaje, fill=Variance))+
  geom_bar(stat = "identity",color="white")+
  coord_polar(theta="y") + 
     geom_text(aes(label=paste(porcentaje, "%")),
              position=position_stack(vjust=0.5),color="white",size=6)+
  coord_polar(theta = "y") + ggtitle("Intraclass correlation redistributive preferences")

reghelper::ICC(results_0_accum)

df<-data.frame(Variance=c("Between","Whithin"),
               porcentaje=c(18,82))
ggplot(df,aes(x="",y=porcentaje, fill=Variance))+
  geom_bar(stat = "identity",color="white")+
  coord_polar(theta="y") + 
     geom_text(aes(label=paste(porcentaje, "%")),
              position=position_stack(vjust=0.5),color="white",size=6)+
  coord_polar(theta = "y") + ggtitle("Intraclass correlation accumulation preferences")
```

> Approximately 15% of the variance of redistributive preferences is found between countries

> Approximately 18% of the variance of redistributive preferences is found between countries.

## Redistributive Preference Models.

```{r results='asis', cache=TRUE} 
results_1_redist__1  = lmer(redist ~  gini_neto + fi_index + pibpc + 1 + (1| v5c), data = mer_pref, REML=F)
results_1_redist_3 = lmer(redist ~ merit + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_redist_4 = lmer(redist ~  merit + bmerit + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_redist_5 = lmer(redist ~  merit + bmerit + unmerit + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_redist_6 = lmer(redist ~ merit + bmerit + unmerit + need + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_redist_7 = lmer(redist ~ gini_neto + fi_index + pibpc + merit + bmerit + unmerit + need + 1 +  (1| v5c), data = mer_pref, REML=F)

results_1_redist_9 = lmer(redist ~ gini_neto + fi_index + pibpc + merit + bmerit + unmerit + need + sstatus + as.factor(movstatus) + univ + as.factor(quintile_miss)  + sex + age  + 1 +  (1| v5c), data = mer_pref, REML=F)

results_2_redist_macro_bv = lmer(redist ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit + bmerit + unmerit + need + gini_neto + fi_index + pibpc + 1 +  (1 + merit| v5c), data= mer_pref, REML=F)
results_3_redist_macro_bvi = lmer(redist ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit + bmerit + unmerit + need + merit*gini_neto + fi_index + pibpc  + 1 +  (1 + merit| v5c), data = mer_pref, REML=F)

```

```{r results='asis'} 
htmlreg(list(results_1_redist__1, results_1_redist_3,results_1_redist_4,results_1_redist_5,results_1_redist_6,results_1_redist_7, results_1_redist_9, results_2_redist_macro_bv, results_3_redist_macro_bvi),
        caption = "Redistributive preference models", 
        omit.coef = "(sstatus)|(movstatus)|(univ)|(quintile_miss)|(age)|(sex)", 
        custom.coef.names = c("Intercept", "Gini index", "Economic freedom index", "PIB per capita", "Meritocratic perception", 
                              "Meritocratic preference", "Unmeritocratic Perception","Unmerit preference", "GINI x Merit-perception"), 
        caption.above = T, 
        star.symbol = "\\*", 
        center = T, 
        custom.note = "$***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> Since Model 6 control by subjetive status, mov subjetive status, Ed.univ, quintile_miss, age and sex") 
```


> __Macroeconomic variables__: At the country level, both wealth and inequality have a negative effect on redistributive preferences. The wealth effect ceases to be significant when the slope is randomized and when inequality interacts with the meritocratic perception effect. For its part, the economic freedom index does not have an effect on meritocracy as it is controlled for inequality and wealth.

> __Meritocratic beliefs__: the meritocratic perception variable does not have a significant effect on the redistributive preferences variable until it is controlled by meritocratic preferences, which have a positive effect on the preference for redistribution. This highlights the importance of differentiating perceptions and preferences in the measurement models, as they can have opposite effects on the same variable, canceling the significance of said effect. In substantive terms this indicates that what is important is the perception of distribution according to talent and effort, apart from the belief that the world should work like this. The effect of this variable grows again when controlling for non-meritocratic perceptions, but decreases considerably when incorporating the variable non-meritocratic preference of payment according to needs. This last variable is the one that has the greatest effect on redistributive preferences, which suggests that the preference for a state that promotes equality is related to the consideration of people's needs when distributing resources.

> __Subjective status__: it can be seen that both have a significant effect even according to a 99.9% confidence criterion. The effect of the subjective status variable is negative, that is, a person who considers himself in a high subjective position has a lower preference for redistribution. For its part, subjective mobility has a positive effect on redistributive preferences, when it is controlled by individual subjective status and meritocratic beliefs. Perhaps, contact with disadvantaged groups can generate greater empathy.

> __Demographic variables__: These variables are all significant. Furthermore, their inclusion in the multilevel model does not nullify the significance of the substantive variables of the model. Among them, the income quintile variable stands out, according to which, belonging to the richest quintile implies a lower preference for redistribution.

> By _randomizing the slope_ between the perception of meritocracy and redistributive preferences significantly improves the model, which is due to the differences between countries regarding said relationship. As exemplified in the graph of random slopes, the relationships even change direction from one country to another.

> By including the _interaction between levels_ the model improves significantly. To some extent, what makes the slope of the relationship vary is the country's inequality.

```{r results='asis', cache=TRUE}
results_1_redist_dem  = lmer(redist ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age + 1 + (1| v5c), data = mer_pref, REML=F)
results_1_redist_indsust = lmer(redist ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit + bmerit + unmerit + need + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_redist_macro = lmer(redist ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit + bmerit + unmerit + need + gini_neto + fi_index + 1 +  (1| v5c), data = mer_pref, REML=F)
results_2_redist_macro_bv = lmer(redist ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit + bmerit + unmerit + need + gini_neto + fi_index + 1 +  (1 + merit| v5c), data= mer_pref, REML=F)
results_3_redist_macro_bvi = lmer(redist ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit + bmerit + unmerit + need + merit*gini_neto + fi_index + 1 +  (1 + merit| v5c), data = mer_pref, REML=F)
results_3_redist_macro_bvi_2 = lmer(redist ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit + bmerit + unmerit + need + merit*fi_index + gini_neto + 1 +  (1 + merit| v5c), data = mer_pref, REML=F)

#htmlreg(list(results_1_redist_macro,results_2_redist_macro_bv, results_3_redist_macro_bvi,results_3_redist_macro_bvi_2), caption = "Pendiente aleatorea e interaccion entre niveles", omit.coef = "(sstatus)|(movstatus)|(univ)|(quintile_miss)|(age)|(sex)")
```


```{r}
results_3_redist_macro_bvi_efectplot <- sjPlot::plot_model(results_3_redist_macro_bvi, type="std", title = "Modelo final con predictores, pendiente aleatoria e interaccion.")
ggsave(results_3_redist_macro_bvi_efectplot, filename = "output/results/results_3_redist_macro_bvi_efectplot.png", width = 10, height = 10, dpi= "retina")

graf2=ggpredict(results_2_redist_macro_bv, terms = c("merit","v5c [DNK, SVN, CHE, FRA, POL, KOR, RUS, CHL, ARG]"), type="re")
pendiente_aleatoria_redistbv <- plot(graf2)
pendiente_aleatoria_redistbv

ggsave(pendiente_aleatoria_redistbv, filename = "output/results/pendiente_aleatoria_redistbv.png", width = 10, height = 10, dpi= "retina")



results_3_redist_macro_bvi_interacgini_meansd <- sjPlot::plot_model(results_3_redist_macro_bvi, 
                                                                    type = c("int"), 
                                                                    title = "Interaccion desigualdad",  
                                                                    mdrt.values = "meansd") +  scale_color_discrete("Gini Index", labels = c("- 1 DS", "Media", "+ 1 DS")) + theme(legend.position = "bottom") + ylab("Redistributive preferences") + xlab("Meritocratic perception")

results_3_redist_macro_bvi_interacgini_minmax <- sjPlot::plot_model(results_3_redist_macro_bvi, 
                                                                    type = c("int"), 
                                                                    title = "Interaccion desigualdad", terms = c ("merit [-3,2]")) +  scale_color_discrete("Gini Index", labels = c("Min", "Max")) + theme(legend.position = "bottom") + ylab("Redistributive preferences") + xlab("Meritocratic perception")
   
ggsave(plot_grid(list(results_3_redist_macro_bvi_efectplot, pendiente_aleatoria_redistbv,results_3_redist_macro_bvi_interacgini_meansd, results_3_redist_macro_bvi_interacgini_minmax) ,
                 margin = c(0.5,0.5,0.5,0.5), 
                 tags = c(" ", " "," ", " ")), 
       filename = "output/results/results_3_redist_macro_bvi_interacgini.png", width = 10, height = 10, dpi= "retina")

#sjPlot::plot_model(results_3_redist_macro_bvi_2, type = c("int"), title = "Interaccion libertad economica",  mdrt.values = "meansd")
```

![Redistribution Models; Effects, Random Slopes, and Interactions](../output/results/results_3_redist_macro_bvi_interacgini.png) 

## Preference Models for marketization (accu).

```{r results='asis', cache=TRUE}
results_1_accum__1  = lmer(accum ~  gini_neto + fi_index + pibpc + 1 + (1| v5c), data = mer_pref, REML=F)
results_1_accum_3 = lmer(accum ~ merit + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_accum_4 = lmer(accum ~  merit + bmerit + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_accum_5 = lmer(accum ~  merit + bmerit + unmerit + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_accum_6 = lmer(accum ~ merit + bmerit + unmerit + need + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_accum_7 = lmer(accum ~ gini_neto + fi_index + pibpc  + merit + bmerit + unmerit + need + 1 +  (1| v5c), data = mer_pref, REML=F)

results_1_accum_8 = lmer(accum ~ gini_neto + fi_index + merit + bmerit + unmerit + need + sstatus + as.factor(movstatus) + 1 +  (1| v5c), data = mer_pref, REML=F)

results_1_accum_9 = lmer(accum ~ gini_neto + fi_index + merit + bmerit + unmerit + need + sstatus + as.factor(movstatus) + univ + as.factor(quintile_miss)  + sex + age  + 1 +  (1| v5c), data = mer_pref, REML=F)

results_1_accum_macro = lmer(accum ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit + bmerit + unmerit + need + gini_neto + fi_index + pibpc + 1 +  (1| v5c), data = mer_pref, REML=F)

results_2_accum_macro_bv = lmer(accum ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit + bmerit + unmerit + need +  gini_neto + fi_index + pibpc + 1 +  (1 + merit| v5c), data = mer_pref, REML=F)

results_3_accum_macro_bvi = lmer(accum ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit + bmerit + unmerit + need +  gini_neto + merit*fi_index + pibpc + 1 +  (1 + merit| v5c), data = mer_pref, REML=F)

results_3_accum_macro_bvi_2 = lmer(accum ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit + bmerit + unmerit + need +  fi_index + merit*gini_neto + pibpc + 1 +  (1 + merit| v5c), data = mer_pref, REML=F)

#htmlreg(list(results_1_accum_macro,results_2_accum_macro_bv,results_3_accum_macro_bvi, results_3_accum_macro_bvi_2), star.symbol = "\\*")
```

```{r, results='asis'}
htmlreg(list(results_1_accum__1, results_1_accum_3,results_1_accum_4,results_1_accum_5,results_1_accum_6,results_1_accum_7, results_2_accum_macro_bv, results_3_accum_macro_bvi), 
        caption = "Accumulation preferences models", 
        omit.coef = "(sstatus)|(movstatus)|(univ)|(quintile_miss)|(age)|(sex)", 
        custom.coef.names = c("Intercept", "Gini index" , "Economic freedom index",  "PIB per capita" , "Meritocratic perception", 
                              "Meritocratic preference", "Unmeritocratic Perception","Unmerit preference", "Economic-freedom Merit-perception"),

        caption.above = T, 
        star.symbol = "\\*", 
        center = T, 
        custom.note = "$***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> Since Model 6 control by subjetive status, mov subjetive status, Ed.univ, quintile_miss, age and sex") 
```

> __Macroeconomic variables__: Only inequality has a positive effect on accumulation preferences, that is, in countries where there are greater income differences, the population tends to validate economic inequality in access to health and education. For its part, economic freedom does not generate a positive effect as might be expected on accumulation preferences.

> __Meritocratic beliefs__: The meritocratic perceptions variable has a significant effect, which grows when controlled by meritocratic preferences and non-meritocratic perceptions. Based on this, we can say that believing that people with greater resources made more effort than people with fewer resources has a significant relationship with justifying socioeconomic inequalities in access to health and education. On the other hand, meritocratic preferences have a negative effect on these beliefs. Given that preferences are controlled by meritocratic perceptions, we can say that those who prefer a distribution according to merit, but do not perceive it, have a greater redistributive preference, which could be explained by their feeling of injustice (_ this idea is similar to those disappointed in Reynols).

> __Subjective status__: it can be seen that both have a significant effect even according to a 99.9% confidence criterion. The effect of the subjective status variable is positive, that is, a person who considers himself in a high subjective position has a greater preference for unequal access to basic services. For its part, subjective mobility has a negative effect on accumulation preferences, when it is controlled by individual subjective status and meritocratic beliefs. Perhaps, contact with disadvantaged groups can generate greater empathy.

> __Demographic variables__: These variables are all significant. Furthermore, their inclusion in the multilevel model does not nullify the significance of the substantive variables of the model. Among them, the income quintile variable stands out.

> Each model is significantly better than the previous one. Regarding the previous model, although the effects are smaller, a much clearer effect of a macro variable can be seen, the gini_neto (This goes along the line of the h: a more unequal country encourages a preference for)

> By randomizing the slope between perception of meritocracy and preferences for commercialization, the model significantly improves, which is due to the differences between countries around said relationship, as exemplified in the graph of random slopes, the relationships even change their direction from one country to another.

> By incorporating the interaction between meritocratic perceptions and economic freedom, the effect of non-meritocratic perception radically changes, which becomes negative. [I have the doubt if when interacting one sees the slope in the smallest value of the macro variable, in this case of fi-index].

```{r}
results_3_accum_macro_bvi_efect <- sjPlot::plot_model(results_3_accum_macro_bvi, type="std", title = "Modelo de pendiente aleatoria e interaccion (desigualdad)")
ggsave(results_3_accum_macro_bvi_efect, filename = "output/results/results_3_accum_macro_bvi_efect.png", width = 10, height = 10, dpi= "retina")

graf2=ggpredict(results_2_accum_macro_bv, terms = c("merit","v5c [DNK, SVN, CHE, FRA, POL, KOR, RUS, ARG, CHL]"), type="re")
pendientealeatoria_accum <- plot(graf2)
ggsave(pendientealeatoria_accum, filename = "output/results/pendientealeatoria_accum.png", width = 10, height = 10, dpi= "retina")

mer_accum_int_f1 <- sjPlot::plot_model(results_3_accum_macro_bvi_2, 
                                       type = c("int"), 
                                       title = "Interaccion Desigualdad",  
                                       mdrt.values = "meansd") +  scale_color_discrete("Gini Index", labels = c("- 1 DS", "Media", "+ 1 DS")) + ylab("Accumulation preferences") + xlab("Meritocratic perception") 

mer_accum_int_f2 <- sjPlot::plot_model(results_3_accum_macro_bvi_2, 
                                       type = c("int"), 
                                       title = "Interaccion Desigualdad") +  scale_color_discrete("Freedom Economic Index", labels = c("Min", "Max")) + ylab("Accumulation preferences") + xlab("Meritocratic perception") 

ggsave(mer_accum_int_f1, filename = "output/results/mer_accum_int_f1.png", width = 10, height = 10, dpi= "retina")

ggsave(plot_grid(list(results_3_accum_macro_bvi_efect, pendientealeatoria_accum,mer_accum_int_f1, mer_accum_int_f2) ,
                 margin = c(0.5,0.5,0.5,0.5), tags = c(" ", " "," ", " ")), 
       filename = "output/results/results_3_accum_macro_bvi_interacgini.png", width = 10, height = 10, dpi= "retina")

#summary(mer_pref$merit) No se puede ampliar el rango del grafico por que ese es el rango de la variable. 
```

![](../output/results/results_3_accum_macro_bvi_interacgini.png)


According to the interaction, we can say that the meritocratic discourse allows to justify the unequal participation of basic rights such as health and education, but only in contexts with low inequality. In countries with high inequality, the perception of meritocracy does not promote the justification of unequal access to basic services, which is hypothesized that may be due to the redical differences between high and low-cost services, differences that due to their consequences do not allow to justify unequal access not even considering the differences of merit.

```{r}
# guardar tablas
#redis 
save(results_1_redist_macro, file = "output/results/results_1_redist_macro.rdata")
save(results_2_redist_macro_bv, file = "output/results/results_2_redist_macro_bv.rdata")
save(results_3_redist_macro_bvi, file = "output/results/results_3_redist_macro_bvi.rdata")

#accum
save(results_1_accum_macro, file = "output/results/results_1_accum_macro.rdata")
save(results_2_accum_macro_bv, file = "output/results/results_2_accum_macro_bv.rdata")
save(results_3_accum_macro_bvi, file = "output/results/results_3_accum_macro_bvi.rdata")
```


## Redistribution and Redistributive preferences

```{r results='asis', cache=TRUE} 
results_1_redist__1r  = lmer(redist ~  redis_relativo + fi_index + pibpc + 1 + (1| v5c), data = mer_pref, REML=F)
results_1_redist_3r = lmer(redist ~ merit + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_redist_4r = lmer(redist ~  merit + bmerit + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_redist_5r = lmer(redist ~  merit + bmerit + unmerit + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_redist_6r = lmer(redist ~ merit + bmerit + unmerit + need + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_redist_7r = lmer(redist ~ redis_relativo + fi_index + pibpc + merit + bmerit + unmerit + need + 1 +  (1| v5c), data = mer_pref, REML=F)

results_1_redist_9r = lmer(redist ~ redis_relativo + fi_index + pibpc + merit + bmerit + unmerit + need + sstatus + as.factor(movstatus) + univ + as.factor(quintile_miss)  + sex + age  + 1 +  (1| v5c), data = mer_pref, REML=F)

results_2_redist_macro_bvr = lmer(redist ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit + bmerit + unmerit + need + redis_relativo + fi_index + pibpc + 1 +  (1 + merit| v5c), data= mer_pref, REML=F)
results_3_redist_macro_bvir = lmer(redist ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit + bmerit + unmerit + need + merit*redis_relativo + fi_index + pibpc  + 1 +  (1 + merit| v5c), data = mer_pref, REML=F)
```

```{r results='asis'} 
htmlreg(list(results_1_redist__1r, results_1_redist_3r,results_1_redist_4r,results_1_redist_5r,results_1_redist_6r,results_1_redist_7r, results_1_redist_9r, results_2_redist_macro_bvr, results_3_redist_macro_bvir),
        caption = "Redistributive preference models", 
        omit.coef = "(sstatus)|(movstatus)|(univ)|(quintile_miss)|(age)|(sex)",
         custom.coef.names = c("Intercept", "Redistribution", "Economic freedom index", "PIB per capita", "Meritocratic perception", 
                              "Meritocratic preference", "Unmeritocratic Perception","Unmerit preference", "Redistribution x Merit-perception"), 
        caption.above = T, 
        star.symbol = "\\*", 
        center = T, 
        custom.note = "$***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> Since Model 6 control by subjetive status, mov subjetive status, Ed.univ, quintile_miss, age and sex") 
```
 
From the analysis carried out, it is concluded that the level of redistribution does not generate a direct effect on the preferences for redistribution. However, it is necessary to consider the evidence from other investigations that propose that this effect occurs in particular conditions, such as affecting more those who receive the positive benefits of net transfers [support transfers - taxes] (Andreoli and Olivera, 2020) .


# Robustness analysis Multilevel Models

## Final regressions without countries in which the measurement model does not converge.
 
```{r, results=TRUE}
mer_pref_sinnonconvr<- mer_pref[which(mer_pref$v5c!='VEN'), ]
mer_pref_sinnonconvr<- mer_pref_sinnonconvr[which(mer_pref_sinnonconvr$v5!=191), ]
mer_pref_sinnonconvr <- mer_pref_sinnonconvr[which(mer_pref_sinnonconvr$v5c!='CYP'), ]
mer_pref_sinnonconvr <- mer_pref_sinnonconvr[which(mer_pref_sinnonconvr$v5!=380), ]
mer_pref_sinnonconvr <- mer_pref_sinnonconvr[which(mer_pref_sinnonconvr$v5!=428), ]

results_3_redist_macro_bvi_nocong = lmer(redist ~ univ + as.factor(quintile_miss) +    sstatus + as.factor(movstatus) + sex + age  + merit + bmerit + unmerit + need + merit*gini_neto + fi_index + pibpc + 1 +  (1 + merit| v5c), data = mer_pref_sinnonconvr, REML=F)

results_3_accum_macro_bvi_nocong = lmer(accum ~ univ + as.factor(quintile_miss) +  sstatus + as.factor(movstatus) + sex + age  + merit + bmerit + unmerit + need +  gini_neto + merit*fi_index  + pibpc + 1 +  (1 + merit| v5c), data = mer_pref_sinnonconvr, REML=F)
```

```{r results='asis'}
htmlreg(list(results_3_redist_macro_bvi, results_3_redist_macro_bvi_nocong, results_3_accum_macro_bvi, results_3_accum_macro_bvi_nocong), 
        caption = "Comparison model excludig countries non convergent in the measurement", 
        custom.model.names = c("Whit", "Whithout","Whit", "Whithout"), 
        custom.header = list("Redistributive" = 1:2, "Accumulation" = 3:4), 
        star.symbol = "\\*", 
        custom.note = "$***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> countries non convergent in the measurement model:Venezuela, Croatia, Cyprus, Italy, Latvia", 
        custom.coef.names = c("Intercept", "University. Ed.", "Quintile 2", "Quintile 3", "Quintile 4","Quintile 5", "Quintile miss", "Subjetive status", 
                              "Subjetive upward mobility", "Supjetive downward mobility","Subjetive non-mobility","Gender", "Age", "Meritorcatic perception", 
                              "Meritocratic preferences", "Unmeritocratic perception", "Unmeritocratic preferences", "Gini index", "Economic freedom index", "PIB per capita",
                              "Merit-perception x Gini", "Merit-perception x Economic-freedom"), 
        caption.above = T)
```

As can be seen in the regressions, the weights of the different variables and their significance do not change substantively when countries that do not converge in the measurement models are excluded from the calculation.


## Influential cases

### Cook Distance

```{r out.width=c('50%', '50%'), fig.cap=" D de Cook", fig.show='hold', results=TRUE,cache=TRUE}
#Redis #
estex.m23_2a <- influence.ME::influence(results_3_redist_macro_bvi, "v5c") 

plota <- plot(estex.m23_2a, which="cook",
              cutoff = 4/39, sort = TRUE,
              xlab = "Cooks Distance Redistributive Model",
              ylab="Contries")

estex.m23_2b <-  influence.ME::influence(results_3_accum_macro_bvi, "v5c") 

plotb <-plot(estex.m23_2b, which="cook",
             cutoff = 4/39, sort = TRUE,
             xlab = "Cooks Distance Accumulation Model",
             ylab="Contries")
```

> cut point > 0.1 (4/39)

### Comparison of the models excluding influential cases at level 2
 
```{r results='asis', results=TRUE}
mer_pref_sininfl <- mer_pref[which(mer_pref$v5c!='ZAF'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='CYP'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='TUR'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='TWN'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='UKR'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='CZE'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='FRA'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='AUS'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='DNK'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='USA'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='VEN'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='PHL'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='POL'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='CHN'), ]

results_3_redist_macro_bvi_sininf = lmer(redist ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit + bmerit + unmerit + need + merit*gini_neto + fi_index + 1 +  (1 + merit| v5c), data = mer_pref_sininfl, REML=F)

mer_pref_sininfl <- mer_pref[which(mer_pref$v5c!='ZAF'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='VEN'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='FRA'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='CHN'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='UKR'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='ISR'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='CHL'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='AUS'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='DNK'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='LVA'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='VEN'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='PHL'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='POL'), ]
mer_pref_sininfl <- mer_pref_sininfl[which(mer_pref_sininfl$v5c!='CZE'), ]

results_3_accum_macro_bvi_sininfl = lmer(accum ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit + bmerit + unmerit + need +  gini_neto + merit*fi_index + pibpc + 1 +  (1 + merit| v5c), data = mer_pref_sininfl, REML=F)
```

```{r results='asis'}
htmlreg(list(results_3_redist_macro_bvi, results_3_redist_macro_bvi_sininf,results_3_accum_macro_bvi, results_3_accum_macro_bvi_sininfl), 
        caption = "Comparison model Without influential cases in level two", 
        custom.model.names = c("Whit", "Whithout","Whit", "Whithout"), 
        custom.header = list("Redistributive" = 1:2, "Accumulation" = 3:4), 
        caption.above = T, 
        star.symbol = "\\*", 
        custom.note = "$***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> Influential contries: CYP, TUR, TWN, UKR,CZE, FRA, AUS, DNK, USA, VEN,PHL, POL, CHN, ISR, CHL, LVA, PHL", 
        custom.coef.names = c("Intercept", "University. Ed.", "Quintile 2", "Quintile 3", "Quintile 4","Quintile 5", "Quintile miss", "Subjetive status", 
                              "Subjetive upward mobility", "Supjetive downward mobility" ,"Subjetive non-mobility","Gender", "Age", "Meritorcatic perception", 
                              "Meritocratic preferences", "Unmeritocratic perception", "Unmeritocratic preferences", "Gini index", "Economic freedom index", "PIB per capita",
                              "Merit-perception x Gini", "Merit-perception x Economic-freedom"))
```

By excluding influential cases, most of the variables do not drastically change meanings or meanings. The fi_index variable becomes significant. The greater the economic freedom, the less redistributive preference.

Considering the substantive variables, when eliminating those countries with a cook distance above the cutoff point (0.1 = 4/39), the meritocratic perception variable loses significance although it gains power, maintaining the rejection of the null hypothesis with 95% of trust. The non-meritocratic perception variable loses half its effect and is no longer significant. In consideration of this evaluation, we can say that the aforementioned relationships are caused to some extent by the 13 countries that

## Centered

### Redistributive prefereneces centered on the group mean

```{r}

mer_pref$merit_g = as.numeric(mer_pref$merit - mer_pref$j_merit)
mer_pref$bmerit_g = as.numeric(mer_pref$bmerit - mer_pref$j_bmerit)
mer_pref$unmerit_g = as.numeric(mer_pref$unmerit - mer_pref$j_unmerit)
mer_pref$need_g = as.numeric(mer_pref$need - mer_pref$j_need)


results_1_redist__1  = lmer(redist ~  gini_neto + fi_index + pibpc + 1 + (1| v5c), data = mer_pref, REML=F)
results_1_redist_3 = lmer(redist ~ merit_g + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_redist_4 = lmer(redist ~  merit_g + bmerit_g + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_redist_5 = lmer(redist ~  merit_g + bmerit_g + unmerit_g + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_redist_6 = lmer(redist ~ merit_g + bmerit_g + unmerit_g + need_g + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_redist_7 = lmer(redist ~ gini_neto + fi_index + pibpc + merit_g + bmerit_g + unmerit_g + need_g + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_redist_9 = lmer(redist ~ gini_neto + fi_index + pibpc + merit_g + bmerit_g + unmerit_g + need_g + sstatus + as.factor(movstatus) + univ + as.factor(quintile_miss)  + sex + age  + 1 +  (1| v5c), data = mer_pref, REML=F)
results_2_redist_macro_bv = lmer(redist ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit_g + bmerit_g + unmerit_g + need_g + gini_neto + fi_index + pibpc + 1 +  (1 + merit| v5c), data= mer_pref, REML=F)
results_3_redist_macro_bvi = lmer(redist ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit_g + bmerit_g + unmerit_g + need_g + merit_g*gini_neto + fi_index + pibpc + 1 +  (1 + merit_g | v5c), data = mer_pref, REML=F)

```

```{r results='asis'} 
htmlreg(list(results_1_redist__1, results_1_redist_3,results_1_redist_4,results_1_redist_5,results_1_redist_6,results_1_redist_7, results_1_redist_9, results_2_redist_macro_bv, results_3_redist_macro_bvi),
        caption = "Redistributive preference models", 
        omit.coef = "(sstatus)|(movstatus)|(univ)|(quintile_miss)|(age)|(sex)", 
        custom.coef.names = c("Intercept", "Gini index", "Economic freedom index", "PIB per capita", "Meritocratic perception", 
                              "Meritocratic preference", "Unmeritocratic Perception","Unmerit preference", "GINI x Merit-perception"), 
        caption.above = T, 
        star.symbol = "\\*", 
        center = T, 
        custom.note = "$***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> Since Model 6 control by subjetive status, mov subjetive status, Ed.univ, quintile_miss, age and sex") 
```




### Accumulation models centered on the group mean

```{r results='asis', cache=TRUE}
results_1_accum__1  = lmer(accum ~  gini_neto + fi_index + pibpc + 1 + (1| v5c), data = mer_pref, REML=F)
results_1_accum__2  = lmer(accum ~  gini_neto + fi_index + pibpc + 1 + (1| v5c), data = mer_pref, REML=F)
results_1_accum_3 = lmer(accum ~ merit_g + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_accum_4 = lmer(accum ~  merit_g + bmerit_g + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_accum_5 = lmer(accum ~ merit_g + bmerit_g + unmerit_g + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_accum_6 = lmer(accum ~ merit_g + bmerit_g + unmerit_g + need_g + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_accum_7 = lmer(accum ~ gini_neto + fi_index + pibpc  + merit_g + bmerit_g + unmerit_g + need_g + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_accum_8 = lmer(accum ~ gini_neto + fi_index + pibpc  + bmerit_g + unmerit_g + need_g + sstatus + as.factor(movstatus) + 1 +  (1| v5c), data = mer_pref, REML=F)

results_1_accum_9 = lmer(accum ~ gini_neto + fi_index + pibpc  + merit_g + bmerit_g + unmerit_g + need_g + sstatus + as.factor(movstatus) + univ + as.factor(quintile_miss)  + sex + age  + 1 +  (1| v5c), data = mer_pref, REML=F)

results_1_accum_macro = lmer(accum ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit_g + bmerit_g + unmerit_g + need_g + gini_neto + fi_index + 1 +  (1| v5c), data = mer_pref, REML=F)

results_2_accum_macro_bv = lmer(accum ~ gini_neto + fi_index + pibpc + univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit_g + bmerit_g + unmerit_g + need_g +  gini_neto + fi_index + 1 +  (1 + merit_g| v5c), data = mer_pref, REML=F)

results_3_accum_macro_bvi = lmer(accum ~ gini_neto + fi_index + pibpc + univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit_g + bmerit_g + unmerit_g + need_g + merit_g*fi_index + 1 +  (1 + merit_g| v5c), data = mer_pref, REML=F)

results_3_accum_macro_bvi_2 = lmer(accum ~ gini_neto + fi_index + pibpc + univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit_g + bmerit_g + unmerit_g + need_g +  merit_g*gini_neto + 1 +  (1 + merit_g| v5c), data = mer_pref, REML=F)

#htmlreg(list(results_1_accum_macro,results_2_accum_macro_bv,results_3_accum_macro_bvi, results_3_accum_macro_bvi_2), star.symbol = "\\*")
```

```{r, results='asis'}
htmlreg(list(results_1_accum__1, results_1_accum_3,results_1_accum_4,results_1_accum_5,results_1_accum_6,results_1_accum_7, results_2_accum_macro_bv, results_3_accum_macro_bvi), 
        caption = "Accumulation preferences models", 
        omit.coef = "(sstatus)|(movstatus)|(univ)|(quintile_miss)|(age)|(sex)", 
        custom.coef.names = c("Intercept", "Gini index" , "Economic freedom index",  "PIB per capita" , "Meritocratic perception", 
                              "Meritocratic preference", "Unmeritocratic Perception","Unmerit preference", "Economic-freedom Merit-perception"),

        caption.above = T, 
        star.symbol = "\\*", 
        center = T, 
        custom.note = "$***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> Since Model 6 control by subjetive status, mov subjetive status, Ed.univ, quintile_miss, age and sex")
```

## Controlling for Efficiency of Governments


```{r}

results_1_redist__1  = lmer(redist ~  gini_neto + fi_index + pibpc + goveffect + 1 + (1| v5c), data = mer_pref, REML=F)
results_1_redist_3 = lmer(redist ~ merit_g + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_redist_4 = lmer(redist ~  merit_g + bmerit_g + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_redist_5 = lmer(redist ~  merit_g + bmerit_g + unmerit_g + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_redist_6 = lmer(redist ~ merit_g + bmerit_g + unmerit_g + need_g + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_redist_7 = lmer(redist ~ gini_neto + fi_index + pibpc + goveffect + merit_g + bmerit_g + unmerit_g + need_g + 1 +  (1| v5c), data = mer_pref, REML=F)
results_1_redist_9 = lmer(redist ~ gini_neto + fi_index + pibpc + goveffect + merit_g + bmerit_g + unmerit_g + need_g + sstatus + as.factor(movstatus) + univ + as.factor(quintile_miss)  + sex + age  + 1 +  (1| v5c), data = mer_pref, REML=F)
results_2_redist_macro_bv = lmer(redist ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit_g + bmerit_g + unmerit_g + need_g + gini_neto + fi_index + pibpc + goveffect + 1 +  (1 + merit| v5c), data= mer_pref, REML=F)
results_3_redist_macro_bvi = lmer(redist ~ univ + as.factor(quintile_miss) +	sstatus + as.factor(movstatus) + sex + age  + merit_g + bmerit_g + unmerit_g + need_g + merit_g*gini_neto + fi_index + pibpc + goveffect + 1 +  (1 + merit_g | v5c), data = mer_pref, REML=F)

```

```{r results='asis'} 
htmlreg(list(results_1_redist__1, results_1_redist_3,results_1_redist_4,results_1_redist_5,results_1_redist_6,results_1_redist_7, results_1_redist_9, results_2_redist_macro_bv, results_3_redist_macro_bvi),
        caption = "Redistributive preference models", 
        omit.coef = "(sstatus)|(movstatus)|(univ)|(quintile_miss)|(age)|(sex)", 
        custom.coef.names = c("Intercept", "Gini index", "Economic freedom index", "PIB per capita", "Gov. Effectiviness", "Meritocratic perception", 
                              "Meritocratic preference", "Unmeritocratic Perception","Unmerit preference", "GINI x Merit-perception"), 
        caption.above = T, 
        star.symbol = "\\*", 
        center = T, 
        custom.note = "$***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> Since Model 6 control by subjetive status, mov subjetive status, Ed.univ, quintile_miss, age and sex") 
```
